<Window x:Class="TickTrader.BotTerminal.ShellView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ad="http://schemas.xceed.com/wpf/xaml/avalondock"
        xmlns:l="clr-namespace:TickTrader.BotTerminal"
        xmlns:cal="http://www.caliburnproject.org"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
        Title="ShellView"
        Height="{l:Setting Window.Height, Default=800}"
        Width="{l:Setting Window.Width, Default=1100}"
        Left="{l:Setting Window.Left}"
        Top="{l:Setting Window.Top}"
        MinWidth="500"
        MinHeight="500"
        Icon="{StaticResource MainAppIcon}"
        Background="{DynamicResource Shell_BackgroundBrush}"
        SnapsToDevicePixels="True"
        TextOptions.TextFormattingMode="Display">
    <Grid>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300" MinWidth="250" MaxWidth="400"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="2*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" MinHeight="150"/>
        </Grid.RowDefinitions>

        <ContentControl Name="AccountPane" Grid.Column="0" Grid.Row="1" Margin="5,0,0,0" />

        <l:TabControl x:Name="LeftPanel" Grid.Column="0" Grid.Row="2" Grid.RowSpan="3" Style="{StaticResource ShellTabControl_Style}" Margin="5,5,0,5">
            <TabItem Header="{l:Resx Tab_Symbols}">
                <ContentControl x:Name="SymbolList"/>
            </TabItem>
            <TabItem Header="{l:Resx Tab_Algo}">
                <ContentControl x:Name="AlgoList"/>
            </TabItem>
        </l:TabControl>

        <ContentControl Name="Charts" Grid.Column="2" Grid.Row="1" Grid.RowSpan="2" Margin="0,0,5,0">
            <i:Interaction.Behaviors>
                <l:DropBehavior/>
            </i:Interaction.Behaviors>
        </ContentControl>
        <GridSplitter Grid.Column="1" Grid.Row="1" Grid.RowSpan="4" Width="5" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Background="Transparent"/>

        <Menu Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="3" Margin="3">
            <MenuItem Header="{l:Resx Menu_BotTrader}" >
                <MenuItem Header="{l:Resx Menu_NewOrder}" IsEnabled="False"/>
                <MenuItem Header="{l:Resx Menu_NewChart}" IsEnabled="False"/>
                <Separator/>
                <MenuItem Header="{l:Resx Menu_LogIn}" cal:Message.Attach="Connect" />
                <MenuItem Header="{l:Resx Menu_LogOut}" cal:Message.Attach="Disconnect" />
                <Separator/>
                <MenuItem Header="{l:Resx Menu_ExitBotTrader}"/>
            </MenuItem>
            <MenuItem Header="{l:Resx Menu_Preferences}">
                <l:MenuItemSelector Header="{l:Resx Menu_Language}"
                                        ItemsSource="{Binding Source={x:Static l:LocaleSelector.Instance},  Path=Locales, Mode=OneWay}"
                                        SelectedItem="{Binding Source={x:Static l:LocaleSelector.Instance}, Path=SelectedLocale, Mode=TwoWay}"/>
                <l:MenuItemSelector Header="{l:Resx Menu_Theme}"
                                        ItemsSource="{Binding Source={x:Static l:ThemeSelector.Instance}, Path=ThemeNames}"
                                        SelectedItem="{Binding Source={x:Static l:ThemeSelector.Instance}, Path=SelectedTheme, Mode=TwoWay}">
                    <l:MenuItemSelector.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{l:ResxBinding Prefix=Theme_}"/>
                        </DataTemplate>
                    </l:MenuItemSelector.ItemTemplate>
                </l:MenuItemSelector>
                <MenuItem Header="Sounds" IsChecked="{Binding Notifications.SoundsEnabled}" IsCheckable="True"></MenuItem>
                <MenuItem Header="Notifications" IsChecked="{Binding Notifications.NotificationsEnabled}" IsCheckable="True"></MenuItem>
            </MenuItem>
        </Menu>

        <GridSplitter Grid.Column="2" Grid.Row="3" Height="5" Width="Auto" HorizontalAlignment="Stretch" Background="Transparent"/>

        <l:TabControl x:Name="BottomPanel" Grid.Column="2" Grid.Row="4" Style="{StaticResource ShellTabControl_Style}" Margin="0,0,5,5" SelectedIndex="4">
            <TabItem Header="{Binding}" Visibility="{Binding Trade.IsEnabled, Converter={StaticResource BoolToVis}}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="{l:Resx Tab_Trade}"></TextBlock>
                            <Border Grid.Column="1" Margin="5 0 0 0" CornerRadius="4" Name="PositionCountPane" Background="{DynamicResource ShellPanel_BackgroundBrush}">
                                <Grid>
                                    <TextBlock Margin="5 0" Text="{Binding Trade.Positions.Net.Positions.Count}" Visibility="{Binding Trade.Positions.Net.IsEnabled, Converter={StaticResource BoolToVis}}"/>
                                    <TextBlock Margin="5 0" Text="{Binding Trade.Positions.Gross.Positions.Count}" Visibility="{Binding Trade.Positions.Gross.IsEnabled, Converter={StaticResource BoolToVis}}"/>
                                </Grid>
                            </Border>
                            <Border Grid.Column="2" Margin="2 0 0 0" CornerRadius="4" Name="OrderCountPane" Background="{DynamicResource ShellPanel_BackgroundBrush}">
                                <TextBlock Margin="5 0" Text="{Binding Trade.Orders.Orders.Count}"/>
                            </Border>
                        </Grid>
                        <DataTemplate.Triggers>
                            <DataTrigger Value="True">
                                <DataTrigger.Binding>
                                    <MultiBinding Converter="{l:BoolConverter ConversionMode=LeastOne}">
                                        <Binding Path="Trade.Positions.Net.Positions.Count" Converter="{l:NumericalComparative ComparisonOption=AboveZero}"/>
                                        <Binding Path="Trade.Positions.Gross.Positions.Count" Converter="{l:NumericalComparative ComparisonOption=AboveZero}"/>
                                        <Binding Path="Trade.Assets.Assets.Count" Converter="{l:NumericalComparative ComparisonOption=AboveZero}"/>
                                    </MultiBinding>
                                </DataTrigger.Binding>
                                <Setter TargetName="PositionCountPane" Property="Background" Value="{DynamicResource RateUpColor}"></Setter>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Trade.Orders.Orders.Count, Converter={l:NumericalComparative ComparisonOption=AboveZero}}" Value="True">
                                <Setter TargetName="OrderCountPane" Property="Background" Value="{DynamicResource RateUpColor}"></Setter>
                            </DataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <ContentControl x:Name="Trade"/>
            </TabItem>
            <TabItem Name="TabHistory" Header="{Binding}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="{l:Resx Tab_History}"></TextBlock>
                            <Border Grid.Column="1" Margin="5 0 0 0" CornerRadius="4" Name="TransactionCountPane" Background="{DynamicResource ShellPanel_BackgroundBrush}">
                                <TextBlock Margin="5 0" Text="{Binding TradeHistory.TradesList.Count}"></TextBlock>
                            </Border>
                        </Grid>
                        <DataTemplate.Triggers>
                            <DataTrigger Binding="{Binding TradeHistory.TradesList.Count, Converter={l:NumericalComparative ComparisonOption=AboveZero}}" Value="True">
                                <Setter TargetName="TransactionCountPane" Property="Background" Value="{DynamicResource RateUpColor}"></Setter>
                            </DataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <ContentControl x:Name="TradeHistory"/>
            </TabItem>
            <TabItem Header="{l:Resx Tab_Journal}" IsSelected="True">
                <ContentControl x:Name="Journal"/>
            </TabItem>
            <TabItem Header="{l:Resx Tab_BotJournal}">
                <ContentControl x:Name="BotJournal"/>
            </TabItem>
        </l:TabControl>

    </Grid>
</Window>
